<!DOCTYPE html>
<html>
<head>
	<title>BlueOcean</title>
	
	<link rel="shortcut icon" href="logo.png">
	<script src="https://www.gstatic.com/firebasejs/7.6.2/firebase-app.js"></script>
	<script src="https://www.gstatic.com/firebasejs/7.6.2/firebase-firestore.js"></script>
	<script src="https://www.gstatic.com/firebasejs/live/3.1/firebase.js"></script>
	<link href="https://fonts.googleapis.com/css?family=Yeon+Sung&display=swap" rel="stylesheet"><meta name="viewport" content="width=device-width, initial-scale=1">
	
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>

<link rel="stylesheet" type="text/css" href="style.css">

</head>
<body>

<div class="container">
	<button id="logout" onclick="logout();" class="glyphicon glyphicon-log-out btn btn-danger">Logout</button>
	<center>
		<h1 class="header">	
			BlueOcean
			<sup>
				<img src="m2.png">
			</sup>
		</h1>
		<div id="output" style="text-align: left;margin-bottom: 70px;"> </div>
	</center>
</div>

<center>
	<div class="input_div_message_page">
		<label>Send:</label>
		<input type="file" id="upload"/>
		<progress id="uploader" value="0" max="100">0%</progress>

<script>

  var uploader = document.getElementById('uploader');
  var fileButton =         document.getElementById('upload');
  fileButton.addEventListener('change', function(e){
  var file = e.target.files[0];
  var storageRef = firebase.storage().ref('img/'+file.name);
  var task = storageRef.put(file);
  task.on('state_changed', function progress(snapshot) {
    var percentage = (snapshot.bytesTransferred/snapshot.totalBytes)*100;
    uploader.value = percentage;

  }, function error(err) {


  },function complete() {

  });
});  
  
  
</script>
<script>

document.getElementById('upload').onchange = uploadOnChange;
    
function uploadOnChange() {
    var filename = this.value;
    var lastIndex = filename.lastIndexOf("\\");
    if (lastIndex >= 0) {
        filename = filename.substring(lastIndex + 1);
    }
    document.getElementById('msg').value = "<a href='https://firebasestorage.googleapis.com/v0/b/caller-80521.appspot.com/o/img%2F" + filename + "?alt=media&token=9ce47441-9c85-47a8-8da5-84afdc3c20c2'>"+filename+"</a>"
}
</script>
</script>
</body>
</html>
		<input type="text" id="msg" class="form-control" placeholder="Message">
		<button onclick="send()" class="btn btn-success">Send</button>
	</div>
</center>

<script src="message_page.js"></script>
</body>
</html>
